# 自动化构建脚本文档

## 简介

本项目包含一个Python自动化构建脚本 (`scripts/build.py`)，用于简化Rust项目的日常开发工作流。该脚本集成了代码格式化、检查、构建和测试等功能，帮助开发者快速执行常见的项目维护任务。

## 环境要求

- Python 3.6 或更高版本
- Rust工具链 (通过 `rustup` 安装)

## 安装

1. 确保已安装Python 3.6+:
   ```bash
   python --version
   ```

2. 确保已安装Rust:
   ```bash
   rustc --version
   ```
   如果未安装Rust，请访问 https://www.rust-lang.org/tools/install 进行安装。

## 使用方法

### 查看帮助信息

```bash
python scripts/build.py --help
```

### 常用命令组合

1. **执行完整的开发流程** (检查、格式化、Clippy、构建、测试):
   ```bash
   python scripts/build.py --all
   ```

2. **仅格式化代码**:
   ```bash
   python scripts/build.py --format
   ```

3. **检查代码格式** (不修改文件):
   ```bash
   python scripts/build.py --check-format
   ```

4. **运行Clippy检查**:
   ```bash
   python scripts/build.py --clippy
   ```

5. **开发构建**:
   ```bash
   python scripts/build.py --build
   ```

6. **发布构建**:
   ```bash
   python scripts/build.py --build --release
   ```

7. **运行测试**:
   ```bash
   python scripts/build.py --test
   ```

8. **运行特定测试**:
   ```bash
   python scripts/build.py --test-name "test_function_name"
   ```

9. **清理构建产物**:
   ```bash
   python scripts/build.py --clean
   ```

10. **检查项目** (快速检查是否有编译错误):
    ```bash
    python scripts/build.py --check
    ```

### 组合使用

您可以组合多个选项来执行一系列操作:

```bash
# 格式化代码并构建
python scripts/build.py --format --build

# 运行测试和Clippy检查
python scripts/build.py --test --clippy

# 检查项目并运行测试
python scripts/build.py --check --test
```

## 脚本功能详解

| 选项 | 功能 | 对应的Cargo命令 |
|------|------|----------------|
| `--format` | 格式化代码 | `cargo fmt` |
| `--check-format` | 检查代码格式 | `cargo fmt --check` |
| `--clippy` | 运行Clippy检查 | `cargo clippy` |
| `--build` | 构建项目 | `cargo build` |
| `--release` | 发布构建 | `cargo build --release` |
| `--test` | 运行测试 | `cargo test` |
| `--test-name` | 运行特定测试 | `cargo test <name>` |
| `--clean` | 清理构建产物 | `cargo clean` |
| `--check` | 检查项目 | `cargo check` |
| `--all` | 执行所有操作 | 组合命令 |

## 错误处理

脚本会在任何步骤失败时立即停止执行，并显示错误信息。您可以根据错误信息进行相应的修复，然后重新运行脚本。

## 平台兼容性

该脚本在Windows、macOS和Linux上均可运行，但需要相应平台已正确安装Python和Rust工具链。