# Rust 终端文件管理 CLI 工具开发文档

## 目标
根据 `1_product_manage.md` 的需求，使用 `clap` 和 `colored` 库，逐步实现文件管理 CLI 工具。

## 阶段一：实现文件浏览与信息展示模块的基础功能

### 功能点 1: `list` 命令列出目录内容

#### 设计
- 主命令: `fmg`
- 子命令: `list` (别名 `ls`)
- 参数:
  - `[PATH]`: 可选的位置参数，指定要列出的目录路径，默认为当前目录 (`.`)。
- 功能:
  - 读取指定路径的目录内容。
  - 使用 `colored` 库对文件和目录进行着色（例如，目录为蓝色）。
  - 简单地打印文件/目录名。

#### 实现步骤
1.  配置 `clap` 定义命令结构。
2.  在 `main.rs` 中实现命令解析逻辑。
3.  实现目录读取和列表打印逻辑。
4.  集成 `colored` 进行基础着色。
5.  测试基本功能。

#### 测试结果
- `cargo run -- list` 成功列出当前目录内容。
- `cargo run -- list src` 成功列出 `src` 目录内容。
- `cargo run -- ls` (别名) 成功工作。
- 目录和文件已根据类型着色。

### 功能点 2: `list` 命令支持 `--long` 或 `-l` 标志显示详细信息

#### 设计
- 新增参数: `--long` 或 `-l` 标志。
- 功能:
  - 显示文件类型、大小、修改时间等详细信息。
  - 使用 `std::fs::metadata` 获取文件元数据。
  - 格式化元数据显示。

#### 实现步骤
1.  修改 `clap` 配置，为 `List` 子命令添加 `--long` 标志。
2.  更新 `list_directory` 函数以处理 `long_format` 参数。
3.  实现元数据获取和格式化逻辑。
4.  添加 `time` crate 用于更好的时间格式化。
5.  测试详细信息显示功能。

#### 测试结果
- `cargo run -- list -l` 成功显示当前目录的详细信息。
- `cargo run -- ls -l src` 成功显示 `src` 目录的详细信息。
- 时间、大小等元数据显示正确。

### 功能点 3: `list` 命令支持 `--tree` 或 `-t` 标志显示树形结构

#### 设计
- 新增参数: `--tree` 或 `-t` 标志。
- 可选参数: `--depth` 或 `-D` 限制树的深度 (注意：为了避免与时间格式化中的 'd' 冲突，短标志改为 'D')。
- 功能:
  - 递归遍历目录结构并以树形方式展示。
  - 使用特殊字符（如 `├──` 和 `└──`）表示层级关系。
  - 支持与 `--long` 标志结合使用。

#### 实现步骤
1.  修改 `clap` 配置，为 `List` 子命令添加 `--tree` 和 `--depth` 标志。
2.  创建新的 `list_directory_tree` 函数处理树形展示逻辑。
3.  实现递归遍历和缩进逻辑。
4.  实现 `--depth` 参数控制递归深度。
5.  测试树形展示功能。

#### 修复的问题
- 修复了在根目录下打印目录名的问题。
- 修复了树形结构前缀不一致的问题。
- 修复了 `--depth` 短标志与时间格式化冲突的问题，将其改为 `-D`。

#### 测试结果
- `cargo run -- list --tree` 成功显示当前目录的树形结构。
- `cargo run -- list --tree --depth 1` (或 `-D 1`) 成功限制树的显示深度。
- `cargo run -- list --tree --depth 2` (或 `-D 2`) 成功显示更深的层级。
- `cargo run -- list --tree -l` 成功结合树形结构和详细信息显示。
- `ls` 别名在树形模式下也正常工作。

#### 后续功能点 (待当前功能点测试通过后)
- 完善权限信息的显示。
- 添加按大小/时间/名称排序的功能。
- 实现快速筛选功能（如仅显示目录、仅显示特定后缀文件）。